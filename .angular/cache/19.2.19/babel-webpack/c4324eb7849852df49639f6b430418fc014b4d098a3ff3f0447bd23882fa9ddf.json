{"ast":null,"code":"import { computed, signal } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst STORAGE_KEY = 'ng19.todo.items';\nexport let TodoService = /*#__PURE__*/(() => {\n  class TodoService {\n    constructor() {\n      this._todos = signal(this.readFromStorage());\n      this.todos = computed(() => this._todos());\n      this.remainingCount = computed(() => this._todos().filter(t => !t.done).length);\n      this.completedCount = computed(() => this._todos().filter(t => t.done).length);\n    }\n    persist() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this._todos()));\n    }\n    readFromStorage() {\n      try {\n        const raw = localStorage.getItem(STORAGE_KEY);\n        return raw ? JSON.parse(raw) : [];\n      } catch {\n        return [];\n      }\n    }\n    add(title) {\n      const now = Date.now();\n      const t = {\n        id: crypto.randomUUID(),\n        title: title.trim(),\n        done: false,\n        createdAt: now,\n        updatedAt: now\n      };\n      if (!t.title) return;\n      this._todos.set([t, ...this._todos()]);\n      this.persist();\n    }\n    toggle(id) {\n      this._todos.update(list => {\n        const updated = list.map(t => t.id === id ? {\n          ...t,\n          done: !t.done,\n          updatedAt: Date.now()\n        } : t);\n        return updated;\n      });\n      this.persist();\n    }\n    updateTitle(id, title) {\n      const next = title.trim();\n      if (!next) return;\n      this._todos.update(list => list.map(t => t.id === id ? {\n        ...t,\n        title: next,\n        updatedAt: Date.now()\n      } : t));\n      this.persist();\n    }\n    remove(id) {\n      this._todos.update(list => list.filter(t => t.id != id));\n      this.persist();\n    }\n    clearCompleted() {\n      this._todos.update(list => list.filter(t => !t.done));\n      this.persist();\n    }\n    replaceAll(items) {\n      this._todos.set(items);\n      this.persist();\n    }\n    static {\n      this.ɵfac = function TodoService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || TodoService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: TodoService,\n        factory: TodoService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return TodoService;\n})();","map":{"version":3,"names":["computed","signal","STORAGE_KEY","TodoService","constructor","_todos","readFromStorage","todos","remainingCount","filter","t","done","length","completedCount","persist","localStorage","setItem","JSON","stringify","raw","getItem","parse","add","title","now","Date","id","crypto","randomUUID","trim","createdAt","updatedAt","set","toggle","update","list","updated","map","updateTitle","next","remove","clearCompleted","replaceAll","items","factory","ɵfac","providedIn"],"sources":["C:\\Users\\PhatTranDuy\\Downloads\\todolist\\todolist\\src\\app\\todo.service.ts"],"sourcesContent":["import { Injectable, computed, signal } from '@angular/core';\r\nimport type { Todo } from './models/todo';\r\n\r\nconst STORAGE_KEY = 'ng19.todo.items';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class TodoService {\r\n  private _todos = signal<Todo[]>(this.readFromStorage());\r\n  readonly todos = computed(() => this._todos());\r\n  readonly remainingCount = computed(() => this._todos().filter(t => !t.done).length);\r\n  readonly completedCount = computed(() => this._todos().filter(t => t.done).length);\r\n\r\n  private persist() {\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(this._todos()));\r\n  }\r\n\r\n  private readFromStorage(): Todo[] {\r\n    try {\r\n      const raw = localStorage.getItem(STORAGE_KEY);\r\n      return raw ? (JSON.parse(raw) as Todo[]) : [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  add(title: string) {\r\n    const now = Date.now();\r\n    const t: Todo = { id: crypto.randomUUID(), title: title.trim(), done: false, createdAt: now, updatedAt: now };\r\n    if (!t.title) return;\r\n    this._todos.set([t, ...this._todos()]);\r\n    this.persist();\r\n  }\r\n\r\n  toggle(id: string) {\r\n    this._todos.update(list => {\r\n      const updated = list.map(t => t.id === id ? { ...t, done: !t.done, updatedAt: Date.now() } : t);\r\n      return updated;\r\n    });\r\n    this.persist();\r\n  }\r\n\r\n  updateTitle(id: string, title: string) {\r\n    const next = title.trim();\r\n    if (!next) return;\r\n    this._todos.update(list => list.map(t => t.id === id ? { ...t, title: next, updatedAt: Date.now() } : t));\r\n    this.persist();\r\n  }\r\n\r\n  remove(id: string) {\r\n    this._todos.update(list => list.filter(t => t.id != id));\r\n    this.persist();\r\n  }\r\n\r\n  clearCompleted() {\r\n    this._todos.update(list => list.filter(t => !t.done));\r\n    this.persist();\r\n  }\r\n\r\n  replaceAll(items: Todo[]) {\r\n    this._todos.set(items);\r\n    this.persist();\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}